{
    "description": "U3BlY2lhbCB0aGFua3MgdG8gQW5kcmVqIEthcnBhdGh5IGZvciBtYWtpbmcgYSB2aWRlbyBhYm91dCB0aGlzLCBpZiB5b3UgaGF2ZW4ndCBhbHJlYWR5IGNoZWNrIG91dCBoaXMgdmlkZW9zIG9uIFlvdVR1YmUgaHR0cHM6Ly95b3V0dS5iZS9WTWotM1MxdGt1MD9zaT1namxuRlA0bzNKUk45ZFRnLiBXcml0ZSBhIFB5dGhvbiBjbGFzcyBzaW1pbGFyIHRvIHRoZSBwcm92aWRlZCAnVmFsdWUnIGNsYXNzIHRoYXQgaW1wbGVtZW50cyB0aGUgYmFzaWMgYXV0b2dyYWQgb3BlcmF0aW9uczogYWRkaXRpb24sIG11bHRpcGxpY2F0aW9uLCBhbmQgUmVMVSBhY3RpdmF0aW9uLiBUaGUgY2xhc3Mgc2hvdWxkIGhhbmRsZSBzY2FsYXIgdmFsdWVzIGFuZCBzaG91bGQgY29ycmVjdGx5IGNvbXB1dGUgZ3JhZGllbnRzIGZvciB0aGVzZSBvcGVyYXRpb25zIHRocm91Z2ggYXV0b21hdGljIGRpZmZlcmVudGlhdGlvbi4=",
    "mdx_file": "c9a4ef2e-c9b9-4653-8a48-c44af59a762e.mdx",
    "tinygrad_difficulty": "medium",
    "tinygrad_starter_code": "ZnJvbSB0aW55Z3JhZC50ZW5zb3IgaW1wb3J0IFRlbnNvcgoKY2xhc3MgVmFsdWU6CiAgICAiIiJTYW1lIGlkZWEsIGJ1dCB1c2luZyB0aW55Z3JhZOKAmXMgYXV0b21hdGljIGRpZmZlcmVudGlhdGlvbi4iIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgZGF0YSwgX3RlbnNvcj1Ob25lKToKICAgICAgICBzZWxmLl90ID0gX3RlbnNvciBpZiBfdGVuc29yIGlzIG5vdCBOb25lIGVsc2UgVGVuc29yKGZsb2F0KGRhdGEpLCByZXF1aXJlc19ncmFkPVRydWUpCgogICAgQHByb3BlcnR5CiAgICBkZWYgZGF0YShzZWxmKToKICAgICAgICByZXR1cm4gZmxvYXQoc2VsZi5fdC5udW1weSgpKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGdyYWQoc2VsZik6CiAgICAgICAgZyA9IHNlbGYuX3QuZ3JhZAogICAgICAgIHJldHVybiAwIGlmIGcgaXMgTm9uZSBlbHNlIGZsb2F0KGcubnVtcHkoKSkKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgZGVmIGZtdCh4KToKICAgICAgICAgICAgcmV0dXJuIGludCh4KSBpZiBmbG9hdCh4KS5pc19pbnRlZ2VyKCkgZWxzZSByb3VuZCh4LCA0KQogICAgICAgIHJldHVybiBmIlZhbHVlKGRhdGE9e2ZtdChzZWxmLmRhdGEpfSwgZ3JhZD17Zm10KHNlbGYuZ3JhZCl9KSIKCiAgICBkZWYgX3dyYXAoc2VsZiwgb3RoZXIpOgogICAgICAgIHJldHVybiBvdGhlciBpZiBpc2luc3RhbmNlKG90aGVyLCBWYWx1ZSkgZWxzZSBWYWx1ZShvdGhlcikKCiAgICBkZWYgX19hZGRfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgb3RoZXIgPSBzZWxmLl93cmFwKG90aGVyKQogICAgICAgIHJldHVybiBWYWx1ZSgwLCBfdGVuc29yPXNlbGYuX3QgKyBvdGhlci5fdCkKCiAgICBfX3JhZGRfXyA9IF9fYWRkX18KCiAgICBkZWYgX19tdWxfXyhzZWxmLCBvdGhlcik6CiAgICAgICAgb3RoZXIgPSBzZWxmLl93cmFwKG90aGVyKQogICAgICAgIHJldHVybiBWYWx1ZSgwLCBfdGVuc29yPXNlbGYuX3QgKiBvdGhlci5fdCkKCiAgICBfX3JtdWxfXyA9IF9fbXVsX18KCiAgICBkZWYgcmVsdShzZWxmKToKICAgICAgICByZXR1cm4gVmFsdWUoMCwgX3RlbnNvcj1zZWxmLl90LnJlbHUoKSkKCiAgICBkZWYgYmFja3dhcmQoc2VsZik6CiAgICAgICAgc2VsZi5fdC5iYWNrd2FyZCgpCg==",
    "test_cases": [
        {
            "test": "a = Value(2);b = Value(3);c = Value(10);d = a + b * c  ;e = Value(7) * Value(2);f = e + d;g = f.relu()  \ng.backward()\nprint(a,b,c,d,e,f,g)\n",
            "expected_output": " Value(data=2, grad=1) Value(data=3, grad=10) Value(data=10, grad=3) Value(data=32, grad=1) Value(data=14, grad=1) Value(data=46, grad=1) Value(data=46, grad=1)"
        }
    ],
    "pytorch_difficulty": "medium",
    "likes": "0",
    "video": [
        "https://youtu.be/VMj-3S1tku0?si=gjlnFP4o3JRN9dTg",
        "https://youtu.be/heSdPbAfFH4"
    ],
    "difficulty": "medium",
    "playground": {
        "dependencies": {},
        "enabled": true,
        "type": "react",
        "settings": {
            "editorHeight": 600,
            "showPreview": true,
            "theme": "auto",
            "showEditor": false,
            "editorWidthPercentage": 35,
            "showConsole": false
        },
        "files": {
            "/App.js": {
                "active": true,
                "code": "import React, { useState, useMemo } from 'react';\n\nconst theme = {\n  colors: {\n    primary: '#8b5cf6',\n    background: '#0a0a0a',\n    surface: '#111111',\n    surfaceAlt: '#1a1a1a',\n    border: '#2a2a2a',\n    text: '#fafafa',\n    textSecondary: '#a1a1aa',\n    textMuted: '#52525b',\n    blue: '#38bdf8',\n    yellow: '#fbbf24',\n    pink: '#f472b6',\n    green: '#a3e635',\n    orange: '#fb923c',\n    red: '#f43f5e',\n  },\n  font: \"'JetBrains Mono', monospace\",\n};\n\nexport default function App() {\n  const [step, setStep] = useState(0);\n  const [playing, setPlaying] = useState(false);\n  const [a, setA] = useState(2);\n  const [b, setB] = useState(3);\n  const [c, setC] = useState(10);\n\n  const numSteps = 5;\n\n  const compute = useMemo(() => {\n    const bc = b * c;\n    const sum = a + bc;\n    const e = Math.max(0, sum);\n    const blocked = sum <= 0;\n    const a_grad = blocked ? 0 : 1;\n    const b_grad = blocked ? 0 : c;\n    const c_grad = blocked ? 0 : b;\n    return { bc, sum, e, a_grad, b_grad, c_grad, blocked };\n  }, [a, b, c]);\n\n  const { bc, sum, e, a_grad, b_grad, c_grad, blocked } = compute;\n\n  const stepInfo = [\n    { title: 'Explore', desc: 'Adjust inputs. Try making a + bÃ—c negative!', color: theme.colors.primary },\n    { title: 'Forward', desc: 'Compute left â†’ right', color: theme.colors.blue },\n    { title: 'Start Backward', desc: 'Output gradient = 1', color: theme.colors.yellow },\n    { title: 'Chain Rule', desc: blocked ? 'ðŸš« ReLU blocks (input â‰¤ 0)' : 'Multiply gradients backward', color: theme.colors.orange },\n    { title: 'Result', desc: 'Final gradients on each input', color: theme.colors.green },\n  ];\n\n  const play = async () => {\n    setPlaying(true);\n    for (let s = 0; s < numSteps; s++) {\n      setStep(s);\n      await new Promise(r => setTimeout(r, 1600));\n    }\n    setPlaying(false);\n  };\n\n  const reset = () => { setStep(0); setPlaying(false); setA(2); setB(3); setC(10); };\n\n  return (\n    <div style={{ background: theme.colors.background, minHeight: '100vh', padding: '12px', fontFamily: theme.font, color: theme.colors.text }}>\n      \n      {/* Header */}\n      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '8px' }}>\n        <div>\n          <div style={{ fontSize: '18px', fontWeight: '700' }}>Autograd: Backpropagation</div>\n          <div style={{ fontSize: '12px', color: theme.colors.textSecondary }}>e = relu(a + b Ã— c)</div>\n        </div>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n          <button onClick={() => setStep(Math.max(0, step - 1))} disabled={step === 0}\n            style={{ padding: '6px 12px', background: theme.colors.surface, border: 'none', borderRadius: '6px',\n              color: step === 0 ? theme.colors.textMuted : theme.colors.text, fontSize: '14px', cursor: 'pointer' }}>{'<'}</button>\n          <div style={{ display: 'flex', gap: '5px' }}>\n            {Array.from({ length: numSteps }, (_, i) => (\n              <div key={i} onClick={() => setStep(i)} style={{\n                width: i === step ? '18px' : '10px', height: '10px', borderRadius: '5px',\n                background: i <= step ? stepInfo[i].color : theme.colors.border, cursor: 'pointer'\n              }} />\n            ))}\n          </div>\n          <button onClick={() => setStep(Math.min(numSteps - 1, step + 1))} disabled={step === numSteps - 1}\n            style={{ padding: '6px 12px', background: step === numSteps - 1 ? theme.colors.surface : theme.colors.primary,\n              border: 'none', borderRadius: '6px', color: theme.colors.text, fontSize: '14px', cursor: 'pointer' }}>{'>'}</button>\n          <button onClick={play} disabled={playing}\n            style={{ padding: '6px 12px', background: playing ? theme.colors.green : theme.colors.surface,\n              border: 'none', borderRadius: '6px', color: playing ? theme.colors.background : theme.colors.text,\n              fontSize: '12px', cursor: 'pointer' }}>{playing ? '...' : 'Play'}</button>\n          <button onClick={reset}\n            style={{ padding: '6px 10px', background: theme.colors.surface, border: 'none', borderRadius: '6px',\n              color: theme.colors.textSecondary, fontSize: '14px', cursor: 'pointer' }}>~</button>\n        </div>\n      </div>\n\n      {/* Step info */}\n      <div style={{ padding: '8px 12px', background: theme.colors.surface, borderLeft: `3px solid ${stepInfo[step].color}`,\n        borderRadius: '0 6px 6px 0', marginBottom: '8px' }}>\n        <span style={{ fontWeight: '600', color: stepInfo[step].color, fontSize: '14px' }}>{stepInfo[step].title}: </span>\n        <span style={{ color: theme.colors.textSecondary, fontSize: '13px' }}>{stepInfo[step].desc}</span>\n      </div>\n\n      {/* Main Graph - Clean horizontal layout */}\n      <div style={{ background: theme.colors.surface, borderRadius: '10px', padding: '12px', marginBottom: '8px' }}>\n        <svg viewBox=\"0 0 750 200\" style={{ width: '100%', height: '200px' }}>\n          <rect x=\"0\" y=\"0\" width=\"750\" height=\"200\" fill={theme.colors.surfaceAlt} rx=\"8\" />\n\n          {/* Row 1: b â†’ Ã— */}\n          {/* Node b */}\n          <circle cx=\"70\" cy=\"50\" r=\"32\" fill={theme.colors.surfaceAlt} stroke={step >= 4 ? (blocked ? theme.colors.red : theme.colors.green) : theme.colors.blue} strokeWidth=\"3\" />\n          <text x=\"70\" y=\"43\" textAnchor=\"middle\" fill={theme.colors.textMuted} fontSize=\"14\">b</text>\n          <text x=\"70\" y=\"62\" textAnchor=\"middle\" fill={theme.colors.blue} fontSize=\"20\" fontWeight=\"bold\">{b}</text>\n          {step >= 4 && <text x=\"70\" y=\"100\" textAnchor=\"middle\" fill={blocked ? theme.colors.red : theme.colors.green} fontSize=\"16\" fontWeight=\"bold\">âˆ‡{b_grad}</text>}\n          \n          {/* Arrow b â†’ Ã— */}\n          <line x1=\"102\" y1=\"50\" x2=\"148\" y2=\"50\" stroke={step >= 1 ? theme.colors.blue : theme.colors.border} strokeWidth=\"3\" />\n          \n          {/* Node Ã— */}\n          <rect x=\"150\" y=\"25\" width=\"50\" height=\"50\" rx=\"8\" fill={theme.colors.surfaceAlt} stroke={step >= 1 ? theme.colors.yellow : theme.colors.border} strokeWidth=\"3\" />\n          <text x=\"175\" y=\"58\" textAnchor=\"middle\" fill={theme.colors.text} fontSize=\"22\" fontWeight=\"bold\">Ã—</text>\n          {step >= 1 && <text x=\"225\" y=\"35\" textAnchor=\"start\" fill={theme.colors.yellow} fontSize=\"16\" fontWeight=\"bold\">{bc}</text>}\n          \n          {/* Node c */}\n          <circle cx=\"70\" cy=\"150\" r=\"32\" fill={theme.colors.surfaceAlt} stroke={step >= 4 ? (blocked ? theme.colors.red : theme.colors.green) : theme.colors.blue} strokeWidth=\"3\" />\n          <text x=\"70\" y=\"143\" textAnchor=\"middle\" fill={theme.colors.textMuted} fontSize=\"14\">c</text>\n          <text x=\"70\" y=\"162\" textAnchor=\"middle\" fill={theme.colors.blue} fontSize=\"20\" fontWeight=\"bold\">{c}</text>\n          {step >= 4 && <text x=\"70\" y=\"195\" textAnchor=\"middle\" fill={blocked ? theme.colors.red : theme.colors.green} fontSize=\"16\" fontWeight=\"bold\">âˆ‡{c_grad}</text>}\n          \n          {/* Arrow c â†’ Ã— */}\n          <line x1=\"102\" y1=\"150\" x2=\"148\" y2=\"150\" stroke={step >= 1 ? theme.colors.blue : theme.colors.border} strokeWidth=\"3\" />\n          <line x1=\"175\" y1=\"75\" x2=\"175\" y2=\"125\" stroke={step >= 1 ? theme.colors.blue : theme.colors.border} strokeWidth=\"3\" />\n          <line x1=\"148\" y1=\"150\" x2=\"175\" y2=\"150\" stroke={step >= 1 ? theme.colors.blue : theme.colors.border} strokeWidth=\"3\" />\n          <line x1=\"175\" y1=\"125\" x2=\"175\" y2=\"150\" stroke={step >= 1 ? theme.colors.blue : theme.colors.border} strokeWidth=\"3\" />\n\n          {/* Arrow Ã— â†’ + */}\n          <line x1=\"200\" y1=\"50\" x2=\"280\" y2=\"100\" stroke={step >= 1 ? theme.colors.blue : theme.colors.border} strokeWidth=\"3\" />\n\n          {/* Node a */}\n          <circle cx=\"220\" cy=\"150\" r=\"32\" fill={theme.colors.surfaceAlt} stroke={step >= 4 ? (blocked ? theme.colors.red : theme.colors.green) : theme.colors.blue} strokeWidth=\"3\" />\n          <text x=\"220\" y=\"143\" textAnchor=\"middle\" fill={theme.colors.textMuted} fontSize=\"14\">a</text>\n          <text x=\"220\" y=\"162\" textAnchor=\"middle\" fill={theme.colors.blue} fontSize=\"20\" fontWeight=\"bold\">{a}</text>\n          {step >= 4 && <text x=\"220\" y=\"195\" textAnchor=\"middle\" fill={blocked ? theme.colors.red : theme.colors.green} fontSize=\"16\" fontWeight=\"bold\">âˆ‡{a_grad}</text>}\n\n          {/* Arrow a â†’ + */}\n          <line x1=\"252\" y1=\"150\" x2=\"280\" y2=\"125\" stroke={step >= 1 ? theme.colors.blue : theme.colors.border} strokeWidth=\"3\" />\n\n          {/* Node + */}\n          <rect x=\"280\" y=\"85\" width=\"50\" height=\"50\" rx=\"8\" fill={theme.colors.surfaceAlt} stroke={step >= 1 ? theme.colors.yellow : theme.colors.border} strokeWidth=\"3\" />\n          <text x=\"305\" y=\"118\" textAnchor=\"middle\" fill={theme.colors.text} fontSize=\"22\" fontWeight=\"bold\">+</text>\n          {step >= 1 && <text x=\"355\" y=\"95\" textAnchor=\"start\" fill={theme.colors.yellow} fontSize=\"16\" fontWeight=\"bold\">{sum}</text>}\n\n          {/* Arrow + â†’ relu */}\n          <line x1=\"330\" y1=\"110\" x2=\"400\" y2=\"110\" stroke={step >= 1 ? theme.colors.yellow : theme.colors.border} strokeWidth=\"3\" />\n\n          {/* Node relu */}\n          <rect x=\"400\" y=\"85\" width=\"70\" height=\"50\" rx=\"8\" fill={theme.colors.surfaceAlt} stroke={step >= 1 ? theme.colors.yellow : theme.colors.border} strokeWidth=\"3\" />\n          <text x=\"435\" y=\"118\" textAnchor=\"middle\" fill={theme.colors.text} fontSize=\"18\" fontWeight=\"bold\">relu</text>\n\n          {/* Arrow relu â†’ e */}\n          <line x1=\"470\" y1=\"110\" x2=\"530\" y2=\"110\" stroke={step >= 1 ? theme.colors.pink : theme.colors.border} strokeWidth=\"3\" />\n\n          {/* Node e (output) */}\n          <circle cx=\"565\" cy=\"110\" r=\"35\" fill={step >= 2 ? (blocked ? theme.colors.red + '25' : theme.colors.green + '25') : theme.colors.surfaceAlt} \n            stroke={step >= 1 ? theme.colors.pink : theme.colors.border} strokeWidth=\"3\" />\n          <text x=\"565\" y=\"103\" textAnchor=\"middle\" fill={theme.colors.textMuted} fontSize=\"14\">e</text>\n          {step >= 1 && <text x=\"565\" y=\"125\" textAnchor=\"middle\" fill={theme.colors.pink} fontSize=\"24\" fontWeight=\"bold\">{e}</text>}\n          {step >= 2 && <text x=\"565\" y=\"160\" textAnchor=\"middle\" fill={theme.colors.yellow} fontSize=\"16\" fontWeight=\"bold\">âˆ‡1</text>}\n\n          {/* BACKWARD FLOW - Simple horizontal arrows below */}\n          {step >= 3 && (\n            <>\n              {/* e â†’ relu */}\n              <line x1=\"530\" y1=\"155\" x2=\"470\" y2=\"155\" stroke={blocked ? theme.colors.red : theme.colors.orange} strokeWidth=\"2.5\" markerEnd=\"url(#backArrow)\" />\n              <text x=\"500\" y=\"172\" textAnchor=\"middle\" fill={blocked ? theme.colors.red : theme.colors.orange} fontSize=\"13\" fontWeight=\"bold\">Ã—1</text>\n              \n              {/* relu â†’ + */}\n              <line x1=\"400\" y1=\"155\" x2=\"330\" y2=\"155\" stroke={blocked ? theme.colors.red : theme.colors.orange} strokeWidth=\"2.5\" markerEnd=\"url(#backArrow)\" />\n              <text x=\"365\" y=\"172\" textAnchor=\"middle\" fill={blocked ? theme.colors.red : theme.colors.orange} fontSize=\"13\" fontWeight=\"bold\">{blocked ? 'Ã—0' : 'Ã—1'}</text>\n            </>\n          )}\n\n          {step >= 4 && !blocked && (\n            <>\n              {/* + â†’ a */}\n              <line x1=\"280\" y1=\"155\" x2=\"252\" y2=\"155\" stroke={theme.colors.orange} strokeWidth=\"2.5\" markerEnd=\"url(#backArrow)\" />\n              <text x=\"266\" y=\"172\" textAnchor=\"middle\" fill={theme.colors.orange} fontSize=\"12\" fontWeight=\"bold\">Ã—1</text>\n              \n              {/* + â†’ Ã— */}\n              <line x1=\"280\" y1=\"60\" x2=\"200\" y2=\"60\" stroke={theme.colors.orange} strokeWidth=\"2.5\" markerEnd=\"url(#backArrow)\" />\n              <text x=\"240\" y=\"55\" textAnchor=\"middle\" fill={theme.colors.orange} fontSize=\"12\" fontWeight=\"bold\">Ã—1</text>\n              \n              {/* Ã— â†’ b */}\n              <line x1=\"150\" y1=\"35\" x2=\"102\" y2=\"35\" stroke={theme.colors.orange} strokeWidth=\"2.5\" markerEnd=\"url(#backArrow)\" />\n              <text x=\"126\" y=\"28\" textAnchor=\"middle\" fill={theme.colors.orange} fontSize=\"12\" fontWeight=\"bold\">Ã—c</text>\n              \n              {/* Ã— â†’ c */}\n              <line x1=\"150\" y1=\"165\" x2=\"102\" y2=\"165\" stroke={theme.colors.orange} strokeWidth=\"2.5\" markerEnd=\"url(#backArrow)\" />\n              <text x=\"126\" y=\"182\" textAnchor=\"middle\" fill={theme.colors.orange} fontSize=\"12\" fontWeight=\"bold\">Ã—b</text>\n            </>\n          )}\n\n          <defs>\n            <marker id=\"backArrow\" markerWidth=\"8\" markerHeight=\"6\" refX=\"0\" refY=\"3\" orient=\"auto\">\n              <polygon points=\"8 3, 0 0, 0 6\" fill={blocked ? theme.colors.red : theme.colors.orange} />\n            </marker>\n          </defs>\n        </svg>\n      </div>\n\n      {/* Bottom panels */}\n      <div style={{ display: 'flex', gap: '10px', marginBottom: '8px' }}>\n        {/* Inputs */}\n        <div style={{ flex: 1, background: theme.colors.surface, borderRadius: '8px', padding: '10px',\n          border: step === 0 ? `2px solid ${theme.colors.primary}` : `1px solid ${theme.colors.border}` }}>\n          <div style={{ fontSize: '12px', color: theme.colors.textMuted, marginBottom: '8px' }}>\n            Inputs {step === 0 && <span style={{ color: theme.colors.primary }}>(adjust)</span>}\n          </div>\n          {[{ n: 'a', v: a, s: setA }, { n: 'b', v: b, s: setB }, { n: 'c', v: c, s: setC }].map((p, i) => (\n            <div key={i} style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '6px' }}>\n              <span style={{ width: '16px', fontSize: '14px', color: theme.colors.blue, fontWeight: '600' }}>{p.n}</span>\n              <input type=\"range\" min={-5} max={10} value={p.v} onChange={e => p.s(+e.target.value)} disabled={step > 0}\n                style={{ flex: 1, accentColor: theme.colors.blue, opacity: step > 0 ? 0.4 : 1 }} />\n              <span style={{ width: '28px', fontSize: '14px', color: theme.colors.blue, fontWeight: '600', textAlign: 'right' }}>{p.v}</span>\n            </div>\n          ))}\n        </div>\n\n        {/* Chain rule breakdown */}\n        <div style={{ flex: 1, background: theme.colors.surface, borderRadius: '8px', padding: '10px' }}>\n          <div style={{ fontSize: '12px', color: theme.colors.textMuted, marginBottom: '8px' }}>Chain Rule</div>\n          <div style={{ fontSize: '13px', lineHeight: 1.7 }}>\n            <div style={{ opacity: step >= 3 ? 1 : 0.3 }}>\n              <span style={{ color: theme.colors.yellow }}>relu':</span> {sum > 0 ? '1 (pass)' : '0 (block)'}\n            </div>\n            <div style={{ opacity: step >= 4 ? 1 : 0.3 }}>\n              <span style={{ color: theme.colors.yellow }}>âˆ‚(a+x)/âˆ‚a:</span> 1\n            </div>\n            <div style={{ opacity: step >= 4 ? 1 : 0.3 }}>\n              <span style={{ color: theme.colors.yellow }}>âˆ‚(bÃ—c)/âˆ‚b:</span> c = {c}\n            </div>\n            <div style={{ opacity: step >= 4 ? 1 : 0.3 }}>\n              <span style={{ color: theme.colors.yellow }}>âˆ‚(bÃ—c)/âˆ‚c:</span> b = {b}\n            </div>\n          </div>\n        </div>\n\n        {/* Results */}\n        <div style={{ flex: 1, background: step >= 4 ? (blocked ? theme.colors.red + '15' : theme.colors.green + '15') : theme.colors.surface, \n          borderRadius: '8px', padding: '10px', border: step >= 4 ? `2px solid ${blocked ? theme.colors.red : theme.colors.green}` : `1px solid ${theme.colors.border}` }}>\n          <div style={{ fontSize: '12px', color: step >= 4 ? (blocked ? theme.colors.red : theme.colors.green) : theme.colors.textMuted, marginBottom: '8px', fontWeight: '600' }}>\n            {blocked && step >= 4 ? 'Blocked!' : 'Gradients'}\n          </div>\n          <div style={{ fontSize: '14px', color: theme.colors.text, opacity: step >= 4 ? 1 : 0.3 }}>\n            <div>a.grad = <span style={{ fontWeight: '700' }}>{a_grad}</span></div>\n            <div>b.grad = <span style={{ fontWeight: '700' }}>{b_grad}</span></div>\n            <div>c.grad = <span style={{ fontWeight: '700' }}>{c_grad}</span></div>\n          </div>\n        </div>\n      </div>\n\n      {/* Key Insight */}\n      <div style={{ background: theme.colors.surfaceAlt, borderRadius: '8px', padding: '10px 14px',\n        fontSize: '12px', color: theme.colors.textSecondary, borderLeft: `3px solid ${theme.colors.primary}` }}>\n        <span style={{ color: theme.colors.primary, fontWeight: '600' }}>Key: </span>\n        {step === 0 && 'Each op stores inputs (_prev) and gradient function (_backward). Try a=-5, b=1, c=1 to see blocking!'}\n        {step === 1 && `Forward: bÃ—c=${bc}, then +a=${sum}, then relu=${e}`}\n        {step === 2 && 'backward() starts at output. Gradient = 1 means \"how much does e change when e changes?\"'}\n        {step === 3 && (blocked ? `ReLU derivative is 0 when input (${sum}) â‰¤ 0. All gradients blocked!` : 'Each op multiplies incoming gradient by local derivative.')}\n        {step === 4 && (blocked ? 'Dying ReLU! No learning signal. Make a+bÃ—c positive.' : `b.grad = âˆ‚e/âˆ‚b = 1Ã—1Ã—1Ã—c = ${c}`)}\n      </div>\n    </div>\n  );\n}"
            }
        }
    },
    "dislikes": "0",
    "example": {
        "input": "a = Value(2)\n        b = Value(-3)\n        c = Value(10)\n        d = a + b * c\n        e = d.relu()\n        e.backward()\n        print(a, b, c, d, e)",
        "reasoning": "The output reflects the forward computation and gradients after backpropagation. The ReLU on 'd' zeros out its output and gradient due to the negative data value.",
        "output": "Value(data=2, grad=0) Value(data=-3, grad=0) Value(data=10, grad=0)"
    },
    "category": "Deep Learning",
    "starter_code": "class Value:\n\tdef __init__(self, data, _children=(), _op=''):\n\t\tself.data = data\n\t\tself.grad = 0\n\t\tself._backward = lambda: None\n\t\tself._prev = set(_children)\n\t\tself._op = _op\n\tdef __repr__(self):\n\t\treturn f\"Value(data={self.data}, grad={self.grad})\"\n\n\tdef __add__(self, other):\n\t\t # Implement addition here\n\t\tpass\n\n\tdef __mul__(self, other):\n\t\t# Implement multiplication here\n\t\tpass\n\n\tdef relu(self):\n\t\t# Implement ReLU here\n\t\tpass\n\n\tdef backward(self):\n\t\t# Implement backward pass here\n\t\tpass",
    "learn_section": "CiMjIFVuZGVyc3RhbmRpbmcgTWF0aGVtYXRpY2FsIENvbmNlcHRzIGluIEF1dG9ncmFkIE9wZXJhdGlvbnMKCipGaXJzdCwgd2F0Y2ggdGhlIHZpZGVvIGluIHRoZSBTb2x1dGlvbiBzZWN0aW9uLioKClRoaXMgdGFzayBmb2N1c2VzIG9uIGltcGxlbWVudGluZyBiYXNpYyBhdXRvbWF0aWMgZGlmZmVyZW50aWF0aW9uIG1lY2hhbmlzbXMgZm9yIG5ldXJhbCBuZXR3b3Jrcy4gVGhlIG9wZXJhdGlvbnMgb2YgYWRkaXRpb24sIG11bHRpcGxpY2F0aW9uLCBhbmQgUmVMVSBhcmUgZnVuZGFtZW50YWwgdG8gbmV1cmFsIG5ldHdvcmsgY29tcHV0YXRpb25zIGFuZCB0aGVpciB0cmFpbmluZyB0aHJvdWdoIGJhY2twcm9wYWdhdGlvbi4KCiMjIyBNYXRoZW1hdGljYWwgRm91bmRhdGlvbnMKCioqQWRkaXRpb24gKGBfX2FkZF9fYCkqKiAgCi0gKipGb3J3YXJkIFBhc3MqKjogRm9yIHR3byBzY2FsYXIgdmFsdWVzIFwoIGEgXCkgYW5kIFwoIGIgXCksIHRoZWlyIHN1bSBcKCBzIFwpIGlzOgogICQkCiAgcyA9IGEgKyBiCiAgJCQKLSAqKkJhY2t3YXJkIFBhc3MqKjogVGhlIGRlcml2YXRpdmUgb2YgXCggcyBcKSB3aXRoIHJlc3BlY3QgdG8gYm90aCBcKCBhIFwpIGFuZCBcKCBiIFwpIGlzIDEuIER1cmluZyBiYWNrcHJvcGFnYXRpb24sIHRoZSBncmFkaWVudCBvZiB0aGUgb3V0cHV0IGlzIHBhc3NlZCBkaXJlY3RseSB0byBib3RoIGlucHV0cy4KCioqTXVsdGlwbGljYXRpb24gKGBfX211bF9fYCkqKiAgCi0gKipGb3J3YXJkIFBhc3MqKjogRm9yIHR3byBzY2FsYXIgdmFsdWVzIFwoIGEgXCkgYW5kIFwoIGIgXCksIHRoZWlyIHByb2R1Y3QgXCggcCBcKSBpczoKICAkJAogIHAgPSBhIFx0aW1lcyBiCiAgJCQKLSAqKkJhY2t3YXJkIFBhc3MqKjogVGhlIGdyYWRpZW50IG9mIFwoIHAgXCkgd2l0aCByZXNwZWN0IHRvIFwoIGEgXCkgaXMgXCggYiBcKSwgYW5kIHdpdGggcmVzcGVjdCB0byBcKCBiIFwpIGlzIFwoIGEgXCkuIER1cmluZyBiYWNrcHJvcGFnYXRpb24sIGVhY2ggaW5wdXQncyBncmFkaWVudCBpcyB0aGUgcHJvZHVjdCBvZiB0aGUgb3RoZXIgaW5wdXQgYW5kIHRoZSBvdXRwdXQncyBncmFkaWVudC4KCioqUmVMVSBBY3RpdmF0aW9uIChgcmVsdWApKiogIAotICoqRm9yd2FyZCBQYXNzKio6IFRoZSBSZUxVIGZ1bmN0aW9uIGlzIGRlZmluZWQgYXM6CiAgJCQKICBSKHgpID0gXG1heCgwLCB4KQogICQkCiAgVGhpcyBmdW5jdGlvbiBvdXRwdXRzIFwoIHggXCkgaWYgXCggeCBcKSBpcyBwb3NpdGl2ZSwgYW5kIDAgb3RoZXJ3aXNlLgotICoqQmFja3dhcmQgUGFzcyoqOiBUaGUgZGVyaXZhdGl2ZSBvZiB0aGUgUmVMVSBmdW5jdGlvbiBpcyAxIGZvciBcKCB4ID4gMCBcKSBhbmQgMCBmb3IgXCggeCBcbGVxIDAgXCkuIFRoZSBncmFkaWVudCBpcyBwcm9wYWdhdGVkIHRocm91Z2ggdGhlIGZ1bmN0aW9uIG9ubHkgaWYgdGhlIGlucHV0IGlzIHBvc2l0aXZlOyBvdGhlcndpc2UsIGl0IHN0b3BzLgoKIyMjIENvbmNlcHR1YWwgQXBwbGljYXRpb24gaW4gTmV1cmFsIE5ldHdvcmtzCi0gKipBZGRpdGlvbiBhbmQgTXVsdGlwbGljYXRpb24qKjogVGhlc2Ugb3BlcmF0aW9ucyBhcmUgdWJpcXVpdG91cyBpbiBuZXVyYWwgbmV0d29ya3MsIGZvcm1pbmcgdGhlIGJhc2lzIGZvciBjb21wdXRpbmcgd2VpZ2h0ZWQgc3VtcyBvZiBpbnB1dHMgaW4gdGhlIG5ldXJvbnMuCi0gKipSZUxVIEFjdGl2YXRpb24qKjogQ29tbW9ubHkgdXNlZCBhcyBhbiBhY3RpdmF0aW9uIGZ1bmN0aW9uIGluIG5ldXJhbCBuZXR3b3JrcyBkdWUgdG8gaXRzIHNpbXBsaWNpdHkgYW5kIGVmZmVjdGl2ZW5lc3MgaW4gaW50cm9kdWNpbmcgbm9uLWxpbmVhcml0eSwgbWFraW5nIGxlYXJuaW5nIGNvbXBsZXggcGF0dGVybnMgcG9zc2libGUuCgpVbmRlcnN0YW5kaW5nIHRoZXNlIG9wZXJhdGlvbnMgYW5kIHRoZWlyIGltcGxpY2F0aW9ucyBvbiBncmFkaWVudCBmbG93IGlzIGNydWNpYWwgZm9yIGRlc2lnbmluZyBhbmQgdHJhaW5pbmcgZWZmZWN0aXZlIG5ldXJhbCBuZXR3b3JrIG1vZGVscy4gQnkgaW1wbGVtZW50aW5nIHRoZXNlIGZyb20gc2NyYXRjaCwgeW91IGdhaW4gZGVlcGVyIGluc2lnaHRzIGludG8gdGhlIHdvcmtpbmdzIG9mIG1vcmUgc29waGlzdGljYXRlZCBkZWVwIGxlYXJuaW5nIGxpYnJhcmllcy4KCg==",
    "title": "Implementing Basic Autograd Operations",
    "contributor": null,
    "pytorch_test_cases": [
        {
            "test": "a = Value(2); b = Value(3); c = Value(10); d = a + b * c; e = Value(7) * Value(2); f = e + d; g = f.relu(); g.backward(); print(a, b, c, d, e, f, g)",
            "expected_output": "Value(data=2, grad=1) Value(data=3, grad=10) Value(data=10, grad=3) Value(data=32, grad=1) Value(data=14, grad=1) Value(data=46, grad=1) Value(data=46, grad=1)"
        }
    ],
    "tinygrad_test_cases": [
        {
            "test": "a = Value(2); b = Value(3); c = Value(10); d = a + b * c; e = Value(7) * Value(2); f = e + d; g = f.relu(); g.backward(); print(a, b, c, d, e, f, g)",
            "expected_output": "Value(data=2, grad=1) Value(data=3, grad=10) Value(data=10, grad=3) Value(data=32, grad=1) Value(data=14, grad=1) Value(data=46, grad=1) Value(data=46, grad=1)"
        }
    ],
    "pytorch_starter_code": "aW1wb3J0IHRvcmNoCgpjbGFzcyBWYWx1ZToKICAgICIiIkEgdGlueSBzY2FsYXIgd3JhcHBlciB0aGF0IGRlbGVnYXRlcyBhbGwgZ3JhZGllbnQgd29yayB0byBQeVRvcmNoIGF1dG9ncmFkLiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkYXRhLCBfdGVuc29yPU5vbmUpOgogICAgICAgICMgbGVhZiBub2RlOiBjcmVhdGUgZnJlc2ggdGVuc29yIHdpdGggZ3JhZDsgaW50ZXJuYWwgbm9kZTogcmV1c2UgdGVuc29yCiAgICAgICAgc2VsZi5fdCA9IF90ZW5zb3IgaWYgX3RlbnNvciBpcyBub3QgTm9uZSBlbHNlIHRvcmNoLnRlbnNvcihmbG9hdChkYXRhKSwgcmVxdWlyZXNfZ3JhZD1UcnVlKQogICAgICAgICMgbWFrZSBzdXJlIGV2ZXJ5IFRlbnNvciAobGVhZiBvciBub3QpIGtlZXBzIGl0cyBncmFkIGZvciBwcmludGluZwogICAgICAgIHNlbGYuX3QucmV0YWluX2dyYWQoKQoKICAgICMgLS0tLS0tLSBjb252ZW5pZW5jZXMgLS0tLS0tLQogICAgQHByb3BlcnR5CiAgICBkZWYgZGF0YShzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fdC5pdGVtKCkKCiAgICBAcHJvcGVydHkKICAgIGRlZiBncmFkKHNlbGYpOgogICAgICAgIGcgPSBzZWxmLl90LmdyYWQKICAgICAgICByZXR1cm4gMCBpZiBnIGlzIE5vbmUgZWxzZSBnLml0ZW0oKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICBkZWYgZm10KHgpOgogICAgICAgICAgICByZXR1cm4gaW50KHgpIGlmIGZsb2F0KHgpLmlzX2ludGVnZXIoKSBlbHNlIHJvdW5kKHgsIDQpCiAgICAgICAgcmV0dXJuIGYiVmFsdWUoZGF0YT17Zm10KHNlbGYuZGF0YSl9LCBncmFkPXtmbXQoc2VsZi5ncmFkKX0pIgoKICAgICMgZW5zdXJlIHJocyBpcyBWYWx1ZQogICAgZGVmIF93cmFwKHNlbGYsIG90aGVyKToKICAgICAgICByZXR1cm4gb3RoZXIgaWYgaXNpbnN0YW5jZShvdGhlciwgVmFsdWUpIGVsc2UgVmFsdWUob3RoZXIpCgogICAgIyAtLS0tLS0tIGFyaXRobWV0aWMgb3BzIC0tLS0tLS0KICAgIGRlZiBfX2FkZF9fKHNlbGYsIG90aGVyKToKICAgICAgICBvdGhlciA9IHNlbGYuX3dyYXAob3RoZXIpCiAgICAgICAgcmV0dXJuIFZhbHVlKDAsIF90ZW5zb3I9c2VsZi5fdCArIG90aGVyLl90KQoKICAgIF9fcmFkZF9fID0gX19hZGRfXwoKICAgIGRlZiBfX211bF9fKHNlbGYsIG90aGVyKToKICAgICAgICBvdGhlciA9IHNlbGYuX3dyYXAob3RoZXIpCiAgICAgICAgcmV0dXJuIFZhbHVlKDAsIF90ZW5zb3I9c2VsZi5fdCAqIG90aGVyLl90KQoKICAgIF9fcm11bF9fID0gX19tdWxfXwoKICAgICMgLS0tLS0tLSBhY3RpdmF0aW9uIC0tLS0tLS0KICAgIGRlZiByZWx1KHNlbGYpOgogICAgICAgIHJldHVybiBWYWx1ZSgwLCBfdGVuc29yPXRvcmNoLnJlbHUoc2VsZi5fdCkpCgogICAgIyAtLS0tLS0tIGJhY2stcHJvcCBlbnRyeSAtLS0tLS0tCiAgICBkZWYgYmFja3dhcmQoc2VsZik6CiAgICAgICAgc2VsZi5fdC5iYWNrd2FyZCgpCg=="
}